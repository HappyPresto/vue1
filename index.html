<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue 1</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/vue.js"></script>
</head>
<body>
    <div class="wrapper">
        <div class="sample">
            <input type="text" v-model = "firstName">
            <input type="text" v-model = "lastName">
            <input type="text" v-model.lazy = "promo"> <!-- ленивая модель, срабатывает после ухода фокуса -->
            <hr>
            <h2>Hello, {{ fullName }}</h2> <!-- {{ $data.name }} -->
            <p>Your sale is {{ sale }}% </p>
            <button class="btn btn-success"
                @click = "addNumber"
            >
            Add Number
            </button>
            <!-- в отличии от methods, fullName не вызывается как функция с () -->
            <hr>
            <ul>
                <li 
                    v-for="(number, index) in numbers"
                    @mouseenter = "onMouseEnter($event, index)"
                    @mouseleave = "onMouseLeave($event, index)"
                >
                    {{index}}:{{ number }}
                </li>
            </ul>
        </div>
    </div>

<script>
    let sample = new Vue({
        el: '.sample', // берет только первый класс, аналог querySelector
        data: { // хранятся все базовые поля, которые мы хотим использовать в рамках нашего эл-та
            firstName: "",
            lastName: "",
            promo: "",
            sale: 0,
            numbers: [0,1,2],
            info: {
                name: "Yura",
                email: "test@mail.ru"
            }
        },
        methods: {
            onChange(e) {
                console.log(this);
                console.log(e);
            },
            /* toggleName: function() {} - сокращенная запись*/
            addNumber() {
                this.numbers.push(Math.floor(Math.random() * 10));
            },
            sortNumbers() {
                this.numbers.sort((a, b) => {
                    return a > b ? 1 : -1
                })
            },
            onMouseEnter(e, index) {
                if (index & 1) {
                    e.target.style.color = "red"
                }
            },
            onMouseLeave(e, index) {
                if (index & 1) {
                    e.target.style.color = "black"
                }
            }
        },
        computed: {
            fullName() {
                return this.firstName + " " + this.lastName;
            }
        },
        watch: {
            promo() {
                getSale(this.promo, (sale) => {
                    this.sale = sale
                })
            }
        }
    }); // создание нового экземпляра класса. В этом классе пишем все настройки для vue.

    function getSale(code, callback) {
        let codes = {
            newYear: 10,
            some: 20
        };

        let sale = (codes[code] !== undefined) ? codes[code] : 0;

        setTimeout(() => {
            callback(sale);
        }, 500);
    }
</script>
</body>
</html>